---------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  /data/uctprgu/cps/program/log_match_edu_basic.log
  log type:  text
 opened on:   3 May 2012, 01:42:57

. 
. local x = 197601

. while `x' <= 201108 {
  2.   quietly {
  3.     if `x' != 197601 & `x' != 197801 & `x' != 198507 & `x' != 198510 & `x' != 1994
> 01 & `x' != 199506 & `x' != 199507 & `x' != 199508 & `x' != 199509 {
  4.           use ../basic_extract/merg`x', replace
  5.           
.           * keep only the records at least 16 years old and with no missing value on 
> labor status in both months and eduction on first month
.           keep if age >= 16
  6. 
.           gen str1 lfs0 = "E" if status0 == 1 | status0 == 2
  7.           replace lfs0 = "U" if status0 == 3 
  8.           replace lfs0 = "I" if status0 == 4 | status0 == 5 | status0 == 6 | statu
> s0 == 7
  9.           replace lfs0 = "U" if status0 == 4 & `x' > 198901
 10.           drop if lfs0 == ""
 11.           gen str1 lfs1 = "E" if status1 == 1 | status1 == 2
 12.           replace lfs1 = "U" if status1 == 3 
 13.           replace lfs1 = "I" if status1 == 4 | status1 == 5 | status1 == 6 | statu
> s1 == 7
 14.           replace lfs1 = "U" if status1 == 4 & `x' > 198900
 15.           drop if lfs1 == ""
 16. 
.           gen str2 lfs2 = lfs0 + lfs1
 17.       
.           * flows conditional on the eduction category of last month
.           drop if educ6c0 == .  
 18.           tostring educ6c0, gen(educ2)
 19. 
.       gen lfsEduc = lfs2 + educ2
 20.           sort lfsEduc
 21. 
.           replace fweight0 = 0 if fweight0 == .
 22.           replace fweight1 = 0 if fweight1 == .
 23.           gen weight = (fweight0 + fweight1) / 2
 24.           egen double flows = sum(weight), by(lfsEduc)
 25.           replace flows = flows/1000
 26.           if `x' > 199400 { 
 27.             replace flows = flows / 100
 28.           }
 29. 
.           sort lfsEduc
 30.           quietly by lfsEduc:  gen duplic = cond(_N==1,0,_n)
 31.           drop if duplic > 1
 32.           keep lfsEduc flows
 33. 
.           gen date = `x'
 34.           reshape wide flows, i(date) j(lfsEduc) string
 35.       
.           forvalues i = 1/6 {
 36.             gen flowEU`i' = flowsEU`i' / (flowsEE`i' + flowsEU`i' + flowsEI`i')
 37.             gen flowUE`i' = flowsUE`i' / (flowsUE`i' + flowsUU`i' + flowsUI`i')
 38.           }
 39.           drop flows*
 40.         }
 41. 
.         else {
 42.           clear
 43.           set obs 1
 44.           gen date = `x'
 45.           forvalues i = 1/6 {
 46.             gen flowEU`i' = .
 47.             gen flowUE`i' = .
 48.           }
 49.         }
 50. 
.         if `x' >= 197602 {
 51.       append using ../result/edu_basic.dta
 52.     }
 53.     
.         saveold ../result/edu_basic.dta, replace
 54.   }
 55.  
.   local x = `x' + 1
 56.   if (`x'-13)/100 == int((`x'-13)/100) {
 57.     local x = `x' + 88
 58.     noisily display (`x'-1)/100
 59.   }
 60. }
1977
1978
1979
1980
1981
1982
1983
1984
1985
1986
1987
1988
1989
1990
1991
1992
1993
1994
1995
1996
1997
1998
1999
2000
2001
2002
2003
2004
2005
2006
2007
2008
2009
2010
2011

. 
. forvalues i = 1/6 {
  2.   rename flowEU`i' flowsEU`i' 
  3.   rename flowUE`i' flowsUE`i'
  4. }

. 
. order _all, seq

. 
. sort date

. gen t = tm(1976m1) + _n - 1

. format t %tm

. tsset t
        time variable:  t, 1976m1 to 2011m8
                delta:  1 month

. gen int year = int( date /100 )

. gen int month = int( (date - year*100) )

. gen qtr = int((month - 1) / 3) + 1

. 
. order year qtr month date t, first

. sort year qtr month date t

. saveold ../result/basic_edu.dta, replace
file ../result/basic_edu.dta saved

. 
. 
. log close
      name:  <unnamed>
       log:  /data/uctprgu/cps/program/log_match_edu_basic.log
  log type:  text
 closed on:   3 May 2012, 01:46:52
---------------------------------------------------------------------------------------
